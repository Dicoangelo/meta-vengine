<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude Command Center</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #050508;
      --bg-secondary: #0d0d14;
      --bg-card: rgba(13, 13, 20, 0.8);
      --bg-hover: rgba(255,255,255,0.04);
      --bg-glass: rgba(255,255,255,0.02);
      --border: rgba(255,255,255,0.06);
      --border-glow: rgba(0, 217, 255, 0.3);
      --text-primary: #f0f0f5;
      --text-secondary: #8a8a9a;
      --text-muted: #4a4a5a;
      --accent-primary: #00d9ff;
      --accent-red: #ff4d6a;
      --accent-orange: #ff7b54;
      --accent-yellow: #ffcc00;
      --accent-cyan: #00d9ff;
      --accent-green: #00ff88;
      --accent-purple: #b14eff;
      --gradient-primary: linear-gradient(135deg, #00d9ff, #00ff88);
      --gradient-accent: linear-gradient(135deg, #ff4d6a, #ff7b54);
      --gradient-glass: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01));
      --glow-cyan: 0 0 20px rgba(0, 217, 255, 0.3);
      --glow-green: 0 0 20px rgba(0, 255, 136, 0.3);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Animated background */
    .bg-grid {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        radial-gradient(circle at 50% 50%, rgba(0, 217, 255, 0.03) 0%, transparent 50%),
        linear-gradient(rgba(0, 217, 255, 0.02) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 217, 255, 0.02) 1px, transparent 1px);
      background-size: 100% 100%, 60px 60px, 60px 60px;
      pointer-events: none;
      z-index: 0;
      animation: gridPulse 8s ease-in-out infinite;
    }

    @keyframes gridPulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }

    /* Navigation */
    .nav {
      display: flex;
      align-items: center;
      background: rgba(5, 5, 8, 0.9);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(24px);
      padding: 0 1.5rem;
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 0.875rem;
      padding: 1rem 0;
      margin-right: 2rem;
    }

    .nav-logo {
      width: 36px;
      height: 36px;
      background: var(--gradient-primary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.3rem;
      box-shadow: var(--glow-cyan);
    }

    .nav-title {
      font-size: 1.15rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
    }

    .nav-tabs {
      display: flex;
      flex: 1;
      gap: 0.25rem;
    }

    .nav-tab {
      padding: 1.25rem 1.25rem;
      cursor: pointer;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.75px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-bottom: 2px solid transparent;
      position: relative;
    }

    .nav-tab:hover {
      color: var(--text-primary);
      background: var(--bg-hover);
    }

    .nav-tab.active {
      color: var(--accent-cyan);
      border-bottom-color: var(--accent-cyan);
      text-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
    }

    .nav-tab .badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--accent-cyan);
      color: var(--bg-primary);
      font-size: 0.6rem;
      padding: 2px 6px;
      border-radius: 10px;
      font-weight: 700;
    }

    .nav-actions {
      display: flex;
      gap: 0.75rem;
      padding: 0 1rem;
    }

    .nav-btn {
      background: var(--bg-glass);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 0.625rem 1.25rem;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 500;
      transition: all 0.3s;
    }

    .nav-btn:hover {
      background: rgba(0, 217, 255, 0.1);
      border-color: var(--border-glow);
      color: var(--accent-cyan);
      box-shadow: var(--glow-cyan);
    }

    /* Main Content */
    .main {
      position: relative;
      z-index: 1;
      max-width: 1600px;
      margin: 0 auto;
      padding: 2rem;
    }

    .tab-content { display: none; animation: fadeIn 0.3s ease; }
    .tab-content.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Cards */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 1.75rem;
      margin-bottom: 1.5rem;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: visible;
      backdrop-filter: blur(10px);
    }

    .card:hover {
      border-color: var(--border-glow);
      box-shadow: var(--glow-cyan), inset 0 1px 0 rgba(255,255,255,0.05);
      transform: translateY(-2px);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .card h3 {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--text-secondary);
      font-weight: 600;
    }

    .card-badge {
      background: rgba(0, 217, 255, 0.1);
      color: var(--accent-cyan);
      padding: 0.3rem 0.875rem;
      border-radius: 20px;
      font-size: 0.7rem;
      font-weight: 600;
      border: 1px solid rgba(0, 217, 255, 0.2);
    }

    /* Proactive Panel (Phase 4 - ProactiveVA) */
    .proactive-panel {
      margin-bottom: 1.5rem;
      animation: slideIn 0.4s ease;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .proactive-card {
      background: linear-gradient(135deg, rgba(72,219,251,0.08), rgba(74,222,128,0.08));
      border-color: rgba(72,219,251,0.3);
    }

    .proactive-card:hover {
      border-color: rgba(72,219,251,0.5);
      box-shadow: 0 0 30px rgba(72,219,251,0.15);
    }

    .proactive-badge {
      background: rgba(72,219,251,0.2) !important;
      color: var(--accent-cyan) !important;
    }

    .suggestions-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.75rem;
    }

    .suggestion-item {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .suggestion-item:hover {
      background: rgba(72,219,251,0.1);
      border-color: rgba(72,219,251,0.3);
      transform: translateY(-2px);
    }

    .suggestion-type {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--accent-cyan);
      margin-bottom: 0.25rem;
    }

    .suggestion-label {
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .suggestion-desc {
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    /* Stats Grid */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.25rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: linear-gradient(135deg, rgba(13, 13, 20, 0.9), rgba(5, 5, 8, 0.9));
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 1.75rem;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .stat-card:hover {
      border-color: var(--border-glow);
      box-shadow: var(--glow-cyan);
      transform: translateY(-3px);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--gradient-primary);
    }

    .stat-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at top left, rgba(0, 217, 255, 0.05), transparent 50%);
      pointer-events: none;
    }

    .stat-card .icon {
      width: 44px;
      height: 44px;
      background: rgba(0, 217, 255, 0.1);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      border: 1px solid rgba(0, 217, 255, 0.2);
    }

    .stat-card .stat-value,
    .stat-card .value {
      font-size: 2.25rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1;
      font-family: 'JetBrains Mono', monospace;
    }

    .stat-card .stat-label,
    .stat-card .label {
      color: var(--text-muted);
      font-size: 0.75rem;
      margin-top: 0.625rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 500;
    }

    .stat-card .trend {
      position: absolute;
      top: 1.25rem;
      right: 1.25rem;
      font-size: 0.75rem;
      padding: 0.3rem 0.625rem;
      border-radius: 8px;
      font-weight: 600;
    }

    .stat-card .trend.up { background: rgba(0, 255, 136, 0.15); color: var(--accent-green); }
    .stat-card .trend.down { background: rgba(255, 77, 106, 0.15); color: var(--accent-red); }

    /* Charts Grid */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 1.5rem;
    }

    .chart-container {
      height: 280px;
      position: relative;
      padding: 0.5rem;
    }

    /* Token Display */
    .token-bar {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
      padding: 1rem 0;
    }

    .token-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      padding: 1rem 1.5rem;
      border-radius: 12px;
      text-align: center;
      min-width: 130px;
    }

    .token-item .value {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
    }

    .token-item .label {
      font-size: 0.7rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 0.25rem;
    }

    /* Memory Tab */
    .memory-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
      gap: 1.5rem;
    }

    .memory-section { margin-bottom: 0; }

    .memory-item {
      background: var(--bg-secondary);
      border-left: 3px solid var(--accent-cyan);
      padding: 1.125rem 1.5rem;
      margin-bottom: 0.875rem;
      border-radius: 0 14px 14px 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .memory-item:hover {
      background: rgba(0, 217, 255, 0.05);
      transform: translateX(8px);
      border-left-color: var(--accent-green);
    }

    .memory-item .content {
      color: var(--text-primary);
      font-size: 0.9rem;
      line-height: 1.6;
    }

    .memory-item .meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.875rem;
    }

    .memory-item .time {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-family: 'JetBrains Mono', monospace;
    }

    .memory-item .tags { display: flex; gap: 0.4rem; flex-wrap: wrap; }

    .tag {
      background: rgba(0, 217, 255, 0.1);
      color: var(--accent-cyan);
      padding: 0.25rem 0.7rem;
      border-radius: 8px;
      font-size: 0.7rem;
      font-weight: 600;
      border: 1px solid rgba(0, 217, 255, 0.2);
    }

    .tag.cyan { background: rgba(0, 217, 255, 0.1); color: var(--accent-cyan); border-color: rgba(0, 217, 255, 0.2); }
    .tag.green { background: rgba(0, 255, 136, 0.1); color: var(--accent-green); border-color: rgba(0, 255, 136, 0.2); }
    .tag.yellow { background: rgba(255, 204, 0, 0.1); color: var(--accent-yellow); border-color: rgba(255, 204, 0, 0.2); }

    /* Activity Tab */
    .activity-container {
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 1.5rem;
    }

    @media (max-width: 1000px) {
      .activity-container { grid-template-columns: 1fr; }
    }

    .activity-timeline {
      background: var(--bg-secondary);
      border-radius: 16px;
      max-height: 600px;
      overflow-y: auto;
      border: 1px solid var(--border);
    }

    .activity-item {
      display: flex;
      align-items: center;
      padding: 0.875rem 1.25rem;
      border-bottom: 1px solid var(--border);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      transition: all 0.2s;
    }

    .activity-item:hover {
      background: rgba(0, 217, 255, 0.03);
    }

    .activity-item .time {
      color: var(--text-muted);
      width: 85px;
      flex-shrink: 0;
    }

    .activity-item .type {
      padding: 0.25rem 0.75rem;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 600;
      width: 75px;
      text-align: center;
      flex-shrink: 0;
      margin-right: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .activity-item .type.write { background: rgba(0, 255, 136, 0.12); color: var(--accent-green); border: 1px solid rgba(0, 255, 136, 0.2); }
    .activity-item .type.edit { background: rgba(255, 204, 0, 0.12); color: var(--accent-yellow); border: 1px solid rgba(255, 204, 0, 0.2); }
    .activity-item .type.bash { background: rgba(0, 217, 255, 0.12); color: var(--accent-cyan); border: 1px solid rgba(0, 217, 255, 0.2); }
    .activity-item .type.session { background: rgba(177, 78, 255, 0.12); color: var(--accent-purple); border: 1px solid rgba(177, 78, 255, 0.2); }

    .activity-item .detail {
      color: var(--text-secondary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .activity-sidebar .card { margin-bottom: 1rem; }

    .heatmap-grid {
      display: grid;
      grid-template-columns: repeat(24, 1fr);
      gap: 4px;
    }

    .heatmap-cell {
      aspect-ratio: 1;
      border-radius: 5px;
      background: var(--bg-secondary);
      position: relative;
      transition: all 0.2s;
    }

    .heatmap-cell:hover {
      transform: scale(1.2);
      z-index: 1;
    }

    .heatmap-cell::after {
      content: attr(data-hour);
      position: absolute;
      bottom: -18px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.6rem;
      color: var(--text-muted);
    }

    .heatmap-cell:nth-child(6n)::after { display: block; }
    .heatmap-cell:not(:nth-child(6n))::after { display: none; }

    /* Cost Tab */
    .cost-hero {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .cost-card {
      background: linear-gradient(135deg, rgba(13, 13, 20, 0.9), rgba(5, 5, 8, 0.9));
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 2.25rem;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .cost-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--gradient-primary);
    }

    .cost-card:hover {
      border-color: var(--border-glow);
      box-shadow: var(--glow-cyan);
      transform: translateY(-3px);
    }

    .cost-card .amount {
      font-size: 3rem;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .cost-card.savings .amount {
      background: linear-gradient(135deg, #00ff88, #00d9ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .cost-card.savings::before {
      background: linear-gradient(135deg, #00ff88, #00d9ff);
    }

    .cost-card .label {
      color: var(--text-muted);
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-top: 0.75rem;
      font-weight: 500;
    }

    .efficiency-bar {
      background: var(--bg-secondary);
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1rem;
    }

    .efficiency-track {
      height: 24px;
      background: var(--bg-card);
      border-radius: 12px;
      overflow: hidden;
      position: relative;
    }

    .efficiency-fill {
      height: 100%;
      background: var(--gradient-secondary);
      border-radius: 12px;
      transition: width 1s ease;
    }

    .efficiency-label {
      display: flex;
      justify-content: space-between;
      margin-top: 0.75rem;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    /* Projects Tab */
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
      gap: 1.5rem;
    }

    .project-card {
      background: linear-gradient(135deg, rgba(13, 13, 20, 0.9), rgba(5, 5, 8, 0.9));
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 1.75rem;
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .project-card:hover {
      border-color: var(--border-glow);
      box-shadow: var(--glow-cyan);
      transform: translateY(-3px);
    }

    .project-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 3px;
      height: 100%;
    }

    .project-card.os-app::before { background: var(--accent-cyan); }
    .project-card.career::before { background: var(--accent-green); }
    .project-card.research::before { background: var(--accent-yellow); }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .project-name {
      font-size: 1.3rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .project-status {
      padding: 0.35rem 0.875rem;
      border-radius: 20px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .project-status.active {
      background: rgba(0, 255, 136, 0.1);
      color: var(--accent-green);
      border: 1px solid rgba(0, 255, 136, 0.2);
    }

    .project-stack {
      color: var(--text-secondary);
      font-size: 0.85rem;
      margin-bottom: 1.25rem;
    }

    .project-stats {
      display: flex;
      gap: 2rem;
      padding-top: 1.25rem;
      border-top: 1px solid var(--border);
    }

    .project-stat .value {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--accent-cyan);
      font-family: 'JetBrains Mono', monospace;
    }

    .project-stat .label {
      font-size: 0.7rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Commands Tab */
    .commands-section {
      margin-bottom: 2.5rem;
    }

    .commands-section h4 {
      font-size: 1rem;
      color: var(--accent-cyan);
      margin-bottom: 1.25rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border);
      font-weight: 600;
    }

    .commands-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1rem;
    }

    .command-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 1.125rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 1.25rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .command-card:hover {
      border-color: var(--border-glow);
      transform: translateY(-2px);
      background: rgba(0, 217, 255, 0.03);
    }

    .command-card code {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.95rem;
      color: var(--accent-cyan);
      background: rgba(0, 217, 255, 0.1);
      padding: 0.45rem 0.9rem;
      border-radius: 8px;
      white-space: nowrap;
      border: 1px solid rgba(0, 217, 255, 0.15);
    }

    .command-card .desc {
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    /* Search Box */
    .search-box {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 0.875rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.875rem;
      margin-bottom: 1.5rem;
      transition: all 0.3s;
    }

    .search-box:focus-within {
      border-color: var(--border-glow);
      box-shadow: var(--glow-cyan);
    }

    .search-box input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: 0.9rem;
      outline: none;
    }

    .search-box input::placeholder { color: var(--text-muted); }

    /* Keyboard Shortcuts */
    kbd {
      background: rgba(0, 217, 255, 0.08);
      border: 1px solid rgba(0, 217, 255, 0.2);
      border-radius: 6px;
      padding: 0.25rem 0.6rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--accent-cyan);
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(0, 217, 255, 0.3); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(0, 217, 255, 0.5); }

    /* Live indicator */
    .live-indicator {
      display: flex;
      align-items: center;
      gap: 0.625rem;
      font-size: 0.75rem;
      color: var(--accent-green);
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .live-dot {
      width: 8px;
      height: 8px;
      background: var(--accent-green);
      border-radius: 50%;
      animation: livePulse 2s ease-in-out infinite;
      box-shadow: 0 0 8px rgba(0, 255, 136, 0.6);
    }

    @keyframes livePulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(0.9); }
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 2.5rem 2rem;
      color: var(--text-muted);
      font-size: 0.8rem;
      border-top: 1px solid var(--border);
      background: rgba(5, 5, 8, 0.5);
      margin-top: 2rem;
    }

    .footer kbd { margin: 0 0.35rem; }

    /* Co-Evolution Tab Styles */
    .coevo-status {
      display: flex;
      flex-direction: column;
      gap: 1.125rem;
      padding: 1.25rem;
    }

    .coevo-config-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.25rem;
      background: var(--bg-secondary);
      border-radius: 12px;
      border: 1px solid var(--border);
      transition: all 0.2s;
    }

    .coevo-config-item:hover {
      border-color: var(--border-glow);
    }

    .config-label {
      color: var(--text-secondary);
    }

    .config-value {
      font-family: 'JetBrains Mono', monospace;
      color: var(--accent-cyan);
      font-weight: 600;
    }

    .patterns-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      max-height: 400px;
      overflow-y: auto;
    }

    .pattern-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      background: var(--bg-hover);
      border-radius: 8px;
      border-left: 3px solid var(--accent-cyan);
    }

    .pattern-info {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .pattern-name {
      font-weight: 600;
      color: var(--text-primary);
    }

    .pattern-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    .pattern-confidence {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      padding: 0.25rem 0.75rem;
      background: rgba(72, 219, 251, 0.1);
      border: 1px solid var(--accent-cyan);
      border-radius: 4px;
      color: var(--accent-cyan);
    }

    #coevo .stat-card {
      border-top: 2px solid var(--accent-cyan);
    }

    /* Context Efficiency Tab Styles */
    .top-packs-list, .pack-combos-list, .pack-inventory-list {
      display: flex;
      flex-direction: column;
      gap: 0.875rem;
      padding: 1.25rem;
    }

    .pack-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.25rem;
      background: var(--bg-secondary);
      border-radius: 12px;
      border: 1px solid var(--border);
      transition: all 0.2s;
    }

    .pack-item:hover {
      border-color: var(--border-glow);
      background: var(--bg-hover);
    }

    .pack-info {
      display: flex;
      flex-direction: column;
      gap: 0.375rem;
    }

    .pack-name {
      font-family: 'JetBrains Mono', monospace;
      color: var(--accent-cyan);
      font-weight: 600;
    }

    .pack-meta {
      display: flex;
      gap: 1rem;
      font-size: 0.825rem;
      color: var(--text-secondary);
    }

    .pack-stats {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }

    .pack-stat {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }

    .pack-stat-value {
      font-family: 'JetBrains Mono', monospace;
      color: var(--accent-green);
      font-weight: 700;
      font-size: 1.1rem;
    }

    .pack-stat-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    .combo-item {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      padding: 1.125rem 1.25rem;
      background: var(--bg-secondary);
      border-radius: 12px;
      border: 1px solid var(--border);
      transition: all 0.2s;
    }

    .combo-item:hover {
      border-color: var(--border-glow);
    }

    .combo-packs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .combo-pack-tag {
      padding: 0.375rem 0.875rem;
      background: rgba(0, 217, 255, 0.1);
      border: 1px solid rgba(0, 217, 255, 0.3);
      border-radius: 6px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--accent-cyan);
    }

    .combo-stats {
      display: flex;
      gap: 2rem;
      font-size: 0.85rem;
    }

    .combo-stat {
      display: flex;
      gap: 0.5rem;
      color: var(--text-secondary);
    }

    .combo-stat-value {
      font-family: 'JetBrains Mono', monospace;
      color: var(--accent-green);
      font-weight: 600;
    }

    /* Routing Styles */
    .routing-progress {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      padding: 1rem 0;
    }

    .progress-item {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .progress-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .progress-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-primary);
      font-weight: 600;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: var(--bg-secondary);
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .progress-fill {
      height: 100%;
      background: var(--gradient-primary);
      transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: var(--glow-cyan);
    }

    .routing-targets {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding: 1rem 0;
    }

    .target-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 1rem;
      background: var(--bg-glass);
      border: 1px solid var(--border);
      border-radius: 8px;
      transition: all 0.2s ease;
    }

    .target-item:hover {
      background: var(--bg-hover);
      border-color: var(--border-glow);
    }

    .target-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
      flex: 1;
    }

    .target-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-primary);
      font-weight: 600;
      margin-right: 1rem;
    }

    .target-status {
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>

  <nav class="nav">
    <div class="nav-brand">
      <div class="nav-logo">C</div>
      <div class="nav-title">Command Center</div>
    </div>
    <div class="nav-tabs">
      <button class="nav-tab active" data-tab="overview">Overview</button>
      <button class="nav-tab" data-tab="memory">Memory</button>
      <button class="nav-tab" data-tab="activity">Activity</button>
      <button class="nav-tab" data-tab="cost">Cost</button>
      <button class="nav-tab" data-tab="projects">Projects</button>
      <button class="nav-tab" data-tab="commands">Commands</button>
      <button class="nav-tab" data-tab="routing">Routing</button>
      <button class="nav-tab" data-tab="coevo">Co-Evolution</button>
      <button class="nav-tab" data-tab="context-efficiency">Context Packs</button>
    </div>
    <div class="nav-actions">
      <div class="live-indicator">
        <div class="live-dot"></div>
        <span>Live</span>
      </div>
      <button class="nav-btn" onclick="location.reload()">Refresh</button>
    </div>
  </nav>

  <main class="main">
    <!-- OVERVIEW TAB -->
    <div id="overview" class="tab-content active">
      <div class="stats-row" id="statsRow"></div>

      <!-- PROACTIVE SUGGESTIONS (Phase 4 - ProactiveVA) -->
      <div id="proactivePanel" class="proactive-panel" style="display:none;">
        <div class="card proactive-card">
          <div class="card-header">
            <h3><span id="proactiveIcon">üéØ</span> <span id="proactiveTitle">Proactive Suggestions</span></h3>
            <span class="card-badge proactive-badge" id="proactivePattern">Detecting...</span>
          </div>
          <div class="proactive-content">
            <p id="proactiveContext" style="color:var(--text-secondary);margin-bottom:1rem;"></p>
            <div id="proactiveSuggestions" class="suggestions-list"></div>
          </div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="card">
          <div class="card-header">
            <h3>Messages Over Time</h3>
            <span class="card-badge">7 Days</span>
          </div>
          <div class="chart-container"><canvas id="messagesChart"></canvas></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>Tool Usage</h3>
            <span class="card-badge">By Day</span>
          </div>
          <div class="chart-container"><canvas id="toolsChart"></canvas></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>Token Consumption</h3>
            <span class="card-badge">Trend</span>
          </div>
          <div class="chart-container"><canvas id="tokensChart"></canvas></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>Activity by Hour</h3>
            <span class="card-badge">Sessions</span>
          </div>
          <div class="chart-container"><canvas id="hourChart"></canvas></div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>Token Breakdown</h3>
          <span class="card-badge" id="modelBadge">Opus 4.5</span>
        </div>
        <div class="token-bar" id="tokenBreakdown"></div>
      </div>
    </div>

    <!-- MEMORY TAB -->
    <div id="memory" class="tab-content">
      <div class="search-box">
        <span>üîç</span>
        <input type="text" id="memorySearch" placeholder="Search memories...">
      </div>
      <div class="memory-grid">
        <div class="card memory-section">
          <div class="card-header">
            <h3>Decisions</h3>
            <span class="card-badge" id="decisionCount">0</span>
          </div>
          <div id="memoryDecisions"></div>
        </div>
        <div class="card memory-section">
          <div class="card-header">
            <h3>Facts</h3>
            <span class="card-badge" id="factCount">0</span>
          </div>
          <div id="memoryFacts"></div>
        </div>
        <div class="card memory-section">
          <div class="card-header">
            <h3>Patterns</h3>
            <span class="card-badge" id="patternCount">0</span>
          </div>
          <div id="memoryPatterns"></div>
        </div>
        <div class="card memory-section">
          <div class="card-header">
            <h3>Project Context</h3>
            <span class="card-badge" id="projectMemCount">0</span>
          </div>
          <div id="memoryProjects"></div>
        </div>
      </div>
    </div>

    <!-- ACTIVITY TAB -->
    <div id="activity" class="tab-content">
      <div class="stats-row">
        <div class="stat-card">
          <div class="icon">üìù</div>
          <div class="value" id="todayActions">0</div>
          <div class="label">Today's Actions</div>
        </div>
        <div class="stat-card">
          <div class="icon">‚úèÔ∏è</div>
          <div class="value" id="todayWrites">0</div>
          <div class="label">Files Written</div>
        </div>
        <div class="stat-card">
          <div class="icon">üîß</div>
          <div class="value" id="todayEdits">0</div>
          <div class="label">Files Edited</div>
        </div>
        <div class="stat-card">
          <div class="icon">üíª</div>
          <div class="value" id="todayBash">0</div>
          <div class="label">Bash Commands</div>
        </div>
      </div>

      <div class="activity-container">
        <div class="card">
          <div class="card-header">
            <h3>Activity Timeline</h3>
            <span class="card-badge" id="activityCount">0 entries</span>
          </div>
          <div class="activity-timeline" id="activityLog"></div>
        </div>
        <div class="activity-sidebar">
          <div class="card">
            <div class="card-header">
              <h3>Hour Heatmap</h3>
            </div>
            <div class="heatmap-grid" id="heatmapGrid"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- COST TAB -->
    <div id="cost" class="tab-content">
      <div class="cost-hero">
        <div class="cost-card">
          <div class="amount" id="costToday">$0</div>
          <div class="label">Today</div>
        </div>
        <div class="cost-card">
          <div class="amount" id="costWeek">$0</div>
          <div class="label">This Week</div>
        </div>
        <div class="cost-card">
          <div class="amount" id="costMonth">$0</div>
          <div class="label">Projected Month</div>
        </div>
        <div class="cost-card savings">
          <div class="amount" id="costSaved">$0</div>
          <div class="label">Saved via Cache</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>Cache Efficiency</h3>
          <span class="card-badge" id="efficiencyPercent">0%</span>
        </div>
        <div class="efficiency-bar">
          <div class="efficiency-track">
            <div class="efficiency-fill" id="efficiencyFill" style="width: 0%"></div>
          </div>
          <div class="efficiency-label">
            <span>0% Cache Miss (Paid)</span>
            <span>100% Cache Hit (Free)</span>
          </div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="card">
          <div class="card-header">
            <h3>Daily Cost Breakdown</h3>
          </div>
          <div class="chart-container"><canvas id="costChart"></canvas></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>Token Efficiency</h3>
          </div>
          <div class="chart-container"><canvas id="efficiencyChart"></canvas></div>
        </div>
      </div>
    </div>

    <!-- PROJECTS TAB -->
    <div id="projects" class="tab-content">
      <div class="projects-grid" id="projectsList"></div>
    </div>

    <!-- COMMANDS TAB -->
    <div id="commands" class="tab-content">
      <div class="commands-section">
        <h4>üöÄ Quick Start</h4>
        <div class="commands-grid">
          <div class="command-card"><code>cx</code><div class="desc">Start Claude tmux session</div></div>
          <div class="command-card"><code>ccc</code><div class="desc">Open Command Center</div></div>
          <div class="command-card"><code>cterm</code><div class="desc">Terminal dashboard</div></div>
        </div>
      </div>

      <div class="commands-section">
        <h4>ü§ñ Model Selection</h4>
        <div class="commands-grid">
          <div class="command-card"><code>cq "..."</code><div class="desc">Haiku ‚Äî quick questions ($0.25/M)</div></div>
          <div class="command-card"><code>cc</code><div class="desc">Sonnet ‚Äî standard coding ($3/M)</div></div>
          <div class="command-card"><code>co</code><div class="desc">Opus ‚Äî complex reasoning ($15/M)</div></div>
        </div>
      </div>

      <div class="commands-section">
        <h4>‚ö° Quick Actions</h4>
        <div class="commands-grid">
          <div class="command-card"><code>q "..."</code><div class="desc">Quick question, no session</div></div>
          <div class="command-card"><code>explain ...</code><div class="desc">Explain any concept</div></div>
          <div class="command-card"><code>fixcmd</code><div class="desc">Fix last failed command</div></div>
        </div>
      </div>

      <div class="commands-section">
        <h4>üì¶ Git Automation</h4>
        <div class="commands-grid">
          <div class="command-card"><code>gsave "msg"</code><div class="desc">Stage all + commit</div></div>
          <div class="command-card"><code>gsync</code><div class="desc">Pull, commit, push</div></div>
          <div class="command-card"><code>gcheckpoint</code><div class="desc">Checkpoint with optional push</div></div>
          <div class="command-card"><code>gquick</code><div class="desc">Auto-generate commit message</div></div>
          <div class="command-card"><code>gbranch name</code><div class="desc">Create and switch branch</div></div>
          <div class="command-card"><code>glog</code><div class="desc">Recent commits (compact)</div></div>
        </div>
      </div>

      <div class="commands-section">
        <h4>üî¨ Research</h4>
        <div class="commands-grid">
          <div class="command-card"><code>research "topic"</code><div class="desc">Start research session</div></div>
          <div class="command-card"><code>rlog URL</code><div class="desc">Log URL to session</div></div>
          <div class="command-card"><code>rstatus</code><div class="desc">Check research status</div></div>
          <div class="command-card"><code>rsearch query</code><div class="desc">Search archives</div></div>
          <div class="command-card"><code>prefetch</code><div class="desc">Load project context</div></div>
          <div class="command-card"><code>rclip</code><div class="desc">Log URL from clipboard</div></div>
        </div>
      </div>

      <div class="commands-section">
        <h4>üìä Monitoring</h4>
        <div class="commands-grid">
          <div class="command-card"><code>ccost</code><div class="desc">Cost tracker</div></div>
          <div class="command-card"><code>today</code><div class="desc">Today's activity</div></div>
          <div class="command-card"><code>cl</code><div class="desc">Live activity log</div></div>
          <div class="command-card"><code>checkpoint</code><div class="desc">Save session checkpoint</div></div>
        </div>
      </div>
    </div>

    <!-- ROUTING TAB -->
    <div id="routing" class="tab-content">
      <div class="stats-row" id="routingStatsRow">
        <div class="stat-card">
          <div class="stat-value" id="routingQueries">‚Äî</div>
          <div class="stat-label">Total Queries</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="routingDqScore">‚Äî</div>
          <div class="stat-label">Avg DQ Score</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="routingCostSavings">‚Äî</div>
          <div class="stat-label">Cost Savings</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="routingLatency">‚Äî</div>
          <div class="stat-label">Latency (p95)</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üéØ Production Readiness</h3>
          <span class="card-badge" id="routingStatusBadge">Collecting</span>
        </div>
        <div class="routing-progress">
          <div class="progress-item">
            <div class="progress-header">
              <span class="progress-label">Query Count</span>
              <span class="progress-value" id="queriesProgress">‚Äî</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="queriesBar" style="width:0%"></div>
            </div>
          </div>
          <div class="progress-item">
            <div class="progress-header">
              <span class="progress-label">Data Quality</span>
              <span class="progress-value" id="dataQualityProgress">‚Äî</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="dataQualityBar" style="width:0%"></div>
            </div>
          </div>
          <div class="progress-item">
            <div class="progress-header">
              <span class="progress-label">Feedback Count</span>
              <span class="progress-value" id="feedbackProgress">‚Äî</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="feedbackBar" style="width:0%"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="card">
          <div class="card-header">
            <h3>üìä Model Distribution</h3>
            <span class="card-badge">Usage</span>
          </div>
          <div class="chart-container"><canvas id="modelDistChart"></canvas></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>‚ö° Performance Targets</h3>
            <span class="card-badge" id="targetsMetBadge">‚Äî</span>
          </div>
          <div class="routing-targets">
            <div class="target-item">
              <span class="target-label">Routing Accuracy</span>
              <span class="target-value" id="accuracyTarget">‚Äî</span>
              <span class="target-status" id="accuracyStatus">‚è≥</span>
            </div>
            <div class="target-item">
              <span class="target-label">Cost Reduction</span>
              <span class="target-value" id="costTarget">‚Äî</span>
              <span class="target-status" id="costStatus">‚è≥</span>
            </div>
            <div class="target-item">
              <span class="target-label">Latency (p95)</span>
              <span class="target-value" id="latencyTarget">‚Äî</span>
              <span class="target-status" id="latencyStatus">‚è≥</span>
            </div>
            <div class="target-item">
              <span class="target-label">DQ Score</span>
              <span class="target-value" id="dqTarget">‚Äî</span>
              <span class="target-status" id="dqStatus">‚è≥</span>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üöÄ Routing Commands</h3>
        </div>
        <div class="commands-grid">
          <div class="command-card"><code>routing-dash</code><div class="desc">View routing dashboard</div></div>
          <div class="command-card"><code>routing-report 7</code><div class="desc">Weekly performance report</div></div>
          <div class="command-card"><code>ai-feedback-enable</code><div class="desc">Enable automated learning</div></div>
          <div class="command-card"><code>ai-feedback-status</code><div class="desc">Check feedback status</div></div>
          <div class="command-card"><code>routing-targets</code><div class="desc">Check target metrics</div></div>
          <div class="command-card"><code>routing-auto status</code><div class="desc">Auto-update system status</div></div>
        </div>
      </div>
    </div>

    <!-- CO-EVOLUTION TAB -->
    <div id="coevo" class="tab-content">
      <div class="stats-row" id="coevoStatsRow">
        <div class="stat-card">
          <div class="stat-value" id="coevoCacheEfficiency">‚Äî</div>
          <div class="stat-label">Cache Efficiency</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="coevoDqScore">‚Äî</div>
          <div class="stat-label">DQ Score</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="coevoDominantPattern">‚Äî</div>
          <div class="stat-label">Dominant Pattern</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="coevoModsApplied">‚Äî</div>
          <div class="stat-label">Mods Applied</div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="card">
          <div class="card-header">
            <h3>‚öôÔ∏è Meta-Vengine Status</h3>
            <span class="card-badge" id="coevoStatusBadge">Active</span>
          </div>
          <div class="coevo-status">
            <div class="coevo-config-item">
              <span class="config-label">Auto-Apply</span>
              <span class="config-value" id="coevoAutoApply">‚Äî</span>
            </div>
            <div class="coevo-config-item">
              <span class="config-label">Min Confidence</span>
              <span class="config-value" id="coevoMinConfidence">‚Äî</span>
            </div>
            <div class="coevo-config-item">
              <span class="config-label">Last Analysis</span>
              <span class="config-value" id="coevoLastAnalysis">‚Äî</span>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>üìä Pattern Distribution</h3>
            <span class="card-badge">Detected</span>
          </div>
          <div class="chart-container"><canvas id="patternChart"></canvas></div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üîÑ Detected Patterns</h3>
          <span class="card-badge" id="patternCount">0</span>
        </div>
        <div id="patternsList" class="patterns-list"></div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üìà Co-Evolution Commands</h3>
        </div>
        <div class="commands-grid">
          <div class="command-card"><code>meta-analyzer analyze</code><div class="desc">Run pattern analysis</div></div>
          <div class="command-card"><code>meta-analyzer propose</code><div class="desc">Generate modification proposals</div></div>
          <div class="command-card"><code>meta-analyzer apply &lt;id&gt;</code><div class="desc">Apply a modification</div></div>
          <div class="command-card"><code>meta-analyzer rollback &lt;id&gt;</code><div class="desc">Revert a modification</div></div>
          <div class="command-card"><code>meta-analyzer dashboard</code><div class="desc">View effectiveness metrics</div></div>
          <div class="command-card"><code>prefetch --pattern &lt;type&gt;</code><div class="desc">Load pattern-aware context</div></div>
        </div>
      </div>
    </div>

    <!-- CONTEXT EFFICIENCY TAB -->
    <div id="context-efficiency" class="tab-content">
      <div class="stats-row" id="contextEfficiencyStatsRow">
        <div class="stat-card">
          <div class="stat-value" id="totalSessions">0</div>
          <div class="stat-label">Sessions Optimized</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="totalTokenSavings">0</div>
          <div class="stat-label">Tokens Saved</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="totalCostSavings">$0.00</div>
          <div class="stat-label">Cost Savings</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="avgReduction">0%</div>
          <div class="stat-label">Avg Reduction</div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="card">
          <div class="card-header">
            <h3>üèÜ Top Performing Packs</h3>
            <span class="card-badge" id="topPacksCount">0</span>
          </div>
          <div id="topPacksList" class="top-packs-list"></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>üìà Daily Savings Trend</h3>
            <span class="card-badge">Last 7 Days</span>
          </div>
          <div class="chart-container"><canvas id="savingsTrendChart"></canvas></div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üîó Best Pack Combinations</h3>
          <span class="card-badge" id="combosCount">0</span>
        </div>
        <div id="packCombosList" class="pack-combos-list"></div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üìä Pack Inventory</h3>
          <span class="card-badge" id="packInventoryCount">0</span>
        </div>
        <div id="packInventoryList" class="pack-inventory-list"></div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3>üõ†Ô∏è Pack Management Commands</h3>
        </div>
        <div class="commands-grid">
          <div class="command-card"><code>python3 build_packs.py --create</code><div class="desc">Create new pack</div></div>
          <div class="command-card"><code>python3 select_packs.py --auto</code><div class="desc">Auto-select packs</div></div>
          <div class="command-card"><code>python3 pack_metrics.py --stats</code><div class="desc">View statistics</div></div>
          <div class="command-card"><code>python3 build_packs.py --list</code><div class="desc">List all packs</div></div>
          <div class="command-card"><code>prefetch-packs --inject</code><div class="desc">Inject into session</div></div>
          <div class="command-card"><code>pack-metrics --dashboard-data</code><div class="desc">Export dashboard data</div></div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    Press <kbd>1</kbd>-<kbd>9</kbd> to switch tabs ¬∑ <kbd>R</kbd> to refresh ¬∑ Built for terminal-first workflow
  </footer>

  <script>
    // Tab switching
    document.querySelectorAll('.nav-tab').forEach((tab, i) => {
      tab.addEventListener('click', () => switchTab(tab.dataset.tab));
    });

    function switchTab(tabId) {
      document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
      document.getElementById(tabId).classList.add('active');
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.target.tagName === 'INPUT') return;
      const tabs = ['overview', 'memory', 'activity', 'cost', 'projects', 'commands', 'routing', 'coevo', 'context-efficiency'];
      if (e.key >= '1' && e.key <= '9') switchTab(tabs[parseInt(e.key) - 1]);
      if (e.key.toLowerCase() === 'r') location.reload();
    });

    // Data injection
    const STATS_DATA = __STATS_DATA__;
    const MEMORY_DATA = __MEMORY_DATA__;
    const ACTIVITY_DATA = __ACTIVITY_DATA__;
    const PROJECTS_DATA = __PROJECTS_DATA__;
    const PROACTIVE_DATA = __PROACTIVE_DATA__;
    const COEVO_DATA = __COEVO_DATA__;
    const SUBSCRIPTION_DATA = __SUBSCRIPTION_DATA__;
    const ROUTING_DATA = __ROUTING_DATA__;

    function formatNumber(n) {
      if (n >= 1000000000) return (n / 1000000000).toFixed(1) + 'B';
      if (n >= 1000000) return (n / 1000000).toFixed(1) + 'M';
      if (n >= 1000) return (n / 1000).toFixed(1) + 'K';
      return n?.toString() || '0';
    }

    function formatCost(n) {
      if (n >= 1000) return '$' + (n / 1000).toFixed(1) + 'K';
      if (n >= 1) return '$' + n.toFixed(2);
      return '$' + n.toFixed(4);
    }

    // Proactive suggestion executor
    function executeSuggestion(type, value) {
      const msg = `Suggestion: ${type} - ${value}\n\nTo use this suggestion:\n`;
      switch(type) {
        case 'skill':
          alert(msg + `Run this in Claude: ${value}`);
          break;
        case 'command':
          alert(msg + `Run in terminal: ${value}`);
          break;
        case 'model':
          alert(msg + `Switch to ${value} model for this task`);
          break;
        case 'memory':
          alert(msg + `Query memory for: ${value}`);
          break;
        default:
          alert(msg + value);
      }
    }

    function init() {
      // Stats row
      const days = STATS_DATA.dailyActivity?.length || 1;
      const totalTools = STATS_DATA.dailyActivity?.reduce((s, d) => s + d.toolCallCount, 0) || 0;
      const avgPerDay = Math.round((STATS_DATA.totalMessages || 0) / days);

      const roiMultiplier = SUBSCRIPTION_DATA?.multiplier || 0;
      const stats = [
        { icon: 'üìä', value: STATS_DATA.totalSessions || 0, label: 'Sessions', trend: '+12%', up: true },
        { icon: 'üí¨', value: STATS_DATA.totalMessages || 0, label: 'Messages', trend: '+8%', up: true },
        { icon: 'üîß', value: totalTools, label: 'Tool Calls', trend: '+15%', up: true },
        { icon: 'üìà', value: avgPerDay, label: 'Avg/Day', trend: null },
        { icon: 'üí∞', value: roiMultiplier + 'x', label: 'ROI', trend: roiMultiplier > 50 ? 'üî•' : null, up: true, raw: true },
        { icon: '‚è±Ô∏è', value: STATS_DATA.longestSession?.messageCount || 0, label: 'Longest', trend: null },
      ];

      document.getElementById('statsRow').innerHTML = stats.map(s => `
        <div class="stat-card">
          <div class="icon">${s.icon}</div>
          <div class="value">${s.raw ? s.value : formatNumber(s.value)}</div>
          <div class="label">${s.label}</div>
          ${s.trend ? `<div class="trend ${s.up ? 'up' : 'down'}">${s.trend}</div>` : ''}
        </div>
      `).join('');

      // Proactive suggestions (Phase 4 - ProactiveVA)
      if (PROACTIVE_DATA.hasContext && PROACTIVE_DATA.suggestions?.length > 0) {
        const panel = document.getElementById('proactivePanel');
        const pattern = PROACTIVE_DATA.topPattern || {};

        document.getElementById('proactiveIcon').textContent = pattern.icon || 'üéØ';
        document.getElementById('proactiveTitle').textContent = 'Proactive Suggestions';
        document.getElementById('proactivePattern').textContent = pattern.name || 'Pattern Detected';
        document.getElementById('proactiveContext').textContent =
          `Based on your recent activity, you appear to be in a ${pattern.name || 'focused'} session.`;

        document.getElementById('proactiveSuggestions').innerHTML =
          PROACTIVE_DATA.suggestions.slice(0, 4).map(s => `
            <div class="suggestion-item" onclick="executeSuggestion('${s.type}', '${s.value}')">
              <div class="suggestion-type">${s.type}</div>
              <div class="suggestion-label">${s.label}</div>
              <div class="suggestion-desc">${s.desc}</div>
            </div>
          `).join('');

        panel.style.display = 'block';
      }

      // Token breakdown
      const modelData = Object.values(STATS_DATA.modelUsage || {})[0] || {};
      const tokens = [
        { label: 'Output', value: modelData.outputTokens || 0, color: 'var(--accent-red)' },
        { label: 'Input', value: modelData.inputTokens || 0, color: 'var(--accent-orange)' },
        { label: 'Cache Read', value: modelData.cacheReadInputTokens || 0, color: 'var(--accent-yellow)' },
        { label: 'Cache Create', value: modelData.cacheCreationInputTokens || 0, color: 'var(--accent-cyan)' }
      ];
      document.getElementById('tokenBreakdown').innerHTML = tokens.map(t => `
        <div class="token-item">
          <div class="value" style="color: ${t.color}">${formatNumber(t.value)}</div>
          <div class="label">${t.label}</div>
        </div>
      `).join('');

      // Charts
      Chart.defaults.color = '#888';
      Chart.defaults.borderColor = 'rgba(255,255,255,0.05)';
      Chart.defaults.font.family = 'Inter';

      const chartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        layout: {
          padding: { left: 10, right: 10, top: 10, bottom: 10 }
        },
        plugins: { legend: { display: false } },
        scales: {
          x: { grid: { display: false }, ticks: { maxRotation: 0, autoSkip: true } },
          y: {
            beginAtZero: true,
            grid: { color: 'rgba(255,255,255,0.05)' },
            ticks: {
              padding: 8,
              callback: function(value) {
                if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
                if (value >= 1000) return (value / 1000).toFixed(0) + 'K';
                return value;
              }
            }
          }
        }
      };

      if (STATS_DATA.dailyActivity?.length) {
        const labels = STATS_DATA.dailyActivity.map(d => d.date.slice(5));

        new Chart(document.getElementById('messagesChart'), {
          type: 'bar',
          data: {
            labels,
            datasets: [{
              data: STATS_DATA.dailyActivity.map(d => d.messageCount),
              backgroundColor: 'rgba(233,69,96,0.8)',
              borderRadius: 8,
              borderSkipped: false
            }]
          },
          options: chartOptions
        });

        new Chart(document.getElementById('toolsChart'), {
          type: 'bar',
          data: {
            labels,
            datasets: [{
              data: STATS_DATA.dailyActivity.map(d => d.toolCallCount),
              backgroundColor: 'rgba(254,202,87,0.8)',
              borderRadius: 8,
              borderSkipped: false
            }]
          },
          options: chartOptions
        });
      }

      if (STATS_DATA.dailyModelTokens?.length) {
        new Chart(document.getElementById('tokensChart'), {
          type: 'line',
          data: {
            labels: STATS_DATA.dailyModelTokens.map(d => d.date.slice(5)),
            datasets: [{
              data: STATS_DATA.dailyModelTokens.map(d => Object.values(d.tokensByModel)[0] || 0),
              borderColor: 'rgba(72,219,251,1)',
              backgroundColor: 'rgba(72,219,251,0.1)',
              fill: true,
              tension: 0.4,
              pointRadius: 6,
              pointBackgroundColor: 'rgba(72,219,251,1)'
            }]
          },
          options: chartOptions
        });
      }

      // Hour chart
      const hourData = Array(24).fill(0);
      Object.entries(STATS_DATA.hourCounts || {}).forEach(([h, c]) => hourData[parseInt(h)] = c);
      const maxHour = Math.max(...hourData);

      new Chart(document.getElementById('hourChart'), {
        type: 'bar',
        data: {
          labels: Array.from({length: 24}, (_, i) => i + 'h'),
          datasets: [{
            data: hourData,
            backgroundColor: hourData.map(v => `rgba(233,69,96,${0.2 + (v/maxHour)*0.8})`),
            borderRadius: 4,
            borderSkipped: false
          }]
        },
        options: chartOptions
      });

      // Memory tab
      const renderMemoryItems = (items, containerId, countId, tagClass = '') => {
        const container = document.getElementById(containerId);
        document.getElementById(countId).textContent = items?.length || 0;

        if (!items?.length) {
          container.innerHTML = '<p style="color:var(--text-muted);padding:1rem;">No items yet</p>';
          return;
        }

        container.innerHTML = items.map(item => `
          <div class="memory-item">
            <div class="content">${item.content}</div>
            <div class="meta">
              <span class="time">${new Date(item.timestamp).toLocaleDateString()}</span>
              <div class="tags">
                ${(item.tags || []).map(t => `<span class="tag ${tagClass}">${t}</span>`).join('')}
              </div>
            </div>
          </div>
        `).join('');
      };

      renderMemoryItems(MEMORY_DATA.decisions, 'memoryDecisions', 'decisionCount');
      renderMemoryItems(MEMORY_DATA.facts, 'memoryFacts', 'factCount', 'cyan');
      renderMemoryItems(MEMORY_DATA.patterns, 'memoryPatterns', 'patternCount', 'yellow');

      const projects = MEMORY_DATA.projects || {};
      document.getElementById('projectMemCount').textContent = Object.keys(projects).length;
      const projectsContainer = document.getElementById('memoryProjects');
      if (Object.keys(projects).length) {
        projectsContainer.innerHTML = Object.entries(projects).map(([key, val]) => `
          <div class="memory-item">
            <div class="content"><strong>${key}:</strong> ${val.content}</div>
            <div class="meta">
              <span class="time">${new Date(val.timestamp).toLocaleDateString()}</span>
              <div class="tags">${(val.tags || []).map(t => `<span class="tag green">${t}</span>`).join('')}</div>
            </div>
          </div>
        `).join('');
      } else {
        projectsContainer.innerHTML = '<p style="color:var(--text-muted);padding:1rem;">No project context yet</p>';
      }

      // Memory search
      document.getElementById('memorySearch').addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        document.querySelectorAll('.memory-item').forEach(item => {
          const content = item.textContent.toLowerCase();
          item.style.display = content.includes(query) ? 'block' : 'none';
        });
      });

      // Activity tab
      const activityLog = document.getElementById('activityLog');
      document.getElementById('activityCount').textContent = ACTIVITY_DATA.length + ' entries';

      activityLog.innerHTML = ACTIVITY_DATA.slice().reverse().map(line => {
        if (line.includes('SESSION')) {
          return `<div class="activity-item"><span class="type session">SESSION</span><span class="detail">${line}</span></div>`;
        }
        const match = line.match(/^(\d{2}:\d{2}:\d{2})\s+(\w+)\s*(.*)?$/);
        if (match) {
          const [, time, type, detail] = match;
          return `<div class="activity-item">
            <span class="time">${time}</span>
            <span class="type ${type.toLowerCase()}">${type}</span>
            <span class="detail">${detail || ''}</span>
          </div>`;
        }
        return `<div class="activity-item"><span class="detail">${line}</span></div>`;
      }).join('');

      // Activity stats
      const todayLines = ACTIVITY_DATA.filter(l => !l.includes('SESSION'));
      document.getElementById('todayActions').textContent = todayLines.length;
      document.getElementById('todayWrites').textContent = todayLines.filter(l => l.includes('WRITE')).length;
      document.getElementById('todayEdits').textContent = todayLines.filter(l => l.includes('EDIT')).length;
      document.getElementById('todayBash').textContent = todayLines.filter(l => l.includes('BASH')).length;

      // Heatmap
      const heatmapGrid = document.getElementById('heatmapGrid');
      heatmapGrid.innerHTML = Array.from({length: 24}, (_, i) => {
        const intensity = hourData[i] / maxHour;
        const color = `rgba(233,69,96,${0.1 + intensity * 0.9})`;
        return `<div class="heatmap-cell" style="background:${color}" data-hour="${i}h" title="${hourData[i]} sessions at ${i}:00"></div>`;
      }).join('');

      // Cost tab
      const cacheRead = modelData.cacheReadInputTokens || 0;
      const inputTokens = modelData.inputTokens || 0;
      const outputTokens = modelData.outputTokens || 0;

      // Opus pricing per million tokens
      const inputCostPerM = 15;
      const outputCostPerM = 75;
      const cacheReadCostPerM = 1.5; // 90% discount

      const actualInputCost = (inputTokens * inputCostPerM) / 1000000;
      const actualOutputCost = (outputTokens * outputCostPerM) / 1000000;
      const actualCost = actualInputCost + actualOutputCost;
      const savedCost = (cacheRead * (inputCostPerM - cacheReadCostPerM)) / 1000000;

      const efficiency = cacheRead / (cacheRead + inputTokens) * 100 || 0;

      document.getElementById('costToday').textContent = formatCost(actualCost / days);
      document.getElementById('costWeek').textContent = formatCost(actualCost);
      document.getElementById('costMonth').textContent = formatCost(actualCost * 4);
      document.getElementById('costSaved').textContent = formatCost(savedCost);
      document.getElementById('efficiencyPercent').textContent = efficiency.toFixed(1) + '%';
      document.getElementById('efficiencyFill').style.width = efficiency + '%';

      // Cost chart
      if (STATS_DATA.dailyModelTokens?.length) {
        new Chart(document.getElementById('costChart'), {
          type: 'bar',
          data: {
            labels: STATS_DATA.dailyModelTokens.map(d => d.date.slice(5)),
            datasets: [{
              label: 'Daily Cost',
              data: STATS_DATA.dailyModelTokens.map(d => {
                const t = Object.values(d.tokensByModel)[0] || 0;
                return (t * 15 / 1000000).toFixed(2);
              }),
              backgroundColor: 'rgba(233,69,96,0.8)',
              borderRadius: 8
            }]
          },
          options: { ...chartOptions, scales: { ...chartOptions.scales, y: { ...chartOptions.scales.y, ticks: { callback: v => '$' + v } } } }
        });

        new Chart(document.getElementById('efficiencyChart'), {
          type: 'doughnut',
          data: {
            labels: ['Cache Hit', 'Cache Miss'],
            datasets: [{
              data: [cacheRead, inputTokens],
              backgroundColor: ['rgba(74,222,128,0.8)', 'rgba(233,69,96,0.8)'],
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { position: 'bottom', labels: { color: '#888' } }
            }
          }
        });
      }

      // Projects tab
      document.getElementById('projectsList').innerHTML = PROJECTS_DATA.map(p => `
        <div class="project-card ${p.class || ''}">
          <div class="project-header">
            <div class="project-name">${p.name}</div>
            <div class="project-status ${p.status}">${p.status}</div>
          </div>
          <div class="project-stack">${p.stack}</div>
          <div class="project-stats">
            <div class="project-stat">
              <div class="value">${p.files || '‚Äî'}</div>
              <div class="label">Files</div>
            </div>
            <div class="project-stat">
              <div class="value">${p.commits || '‚Äî'}</div>
              <div class="label">Commits</div>
            </div>
            <div class="project-stat">
              <div class="value">${p.lines || '‚Äî'}</div>
              <div class="label">Lines</div>
            </div>
          </div>
        </div>
      `).join('');

      // Co-Evolution tab
      if (COEVO_DATA) {
        document.getElementById('coevoCacheEfficiency').textContent =
          (COEVO_DATA.cacheEfficiency || 0).toFixed(1) + '%';
        document.getElementById('coevoDqScore').textContent =
          (COEVO_DATA.dqScore || 0).toFixed(3);
        document.getElementById('coevoDominantPattern').textContent =
          COEVO_DATA.dominantPattern || 'none';
        document.getElementById('coevoModsApplied').textContent =
          COEVO_DATA.modsApplied || 0;
        document.getElementById('coevoAutoApply').textContent =
          COEVO_DATA.autoApply ? 'Enabled' : 'Disabled';
        document.getElementById('coevoMinConfidence').textContent =
          (COEVO_DATA.minConfidence || 0.7).toFixed(2);
        document.getElementById('coevoLastAnalysis').textContent =
          COEVO_DATA.lastAnalysis || 'Never';

        // Pattern chart
        const patterns = COEVO_DATA.patterns || [];
        if (patterns.length > 0) {
          document.getElementById('patternCount').textContent = patterns.length;

          new Chart(document.getElementById('patternChart'), {
            type: 'doughnut',
            data: {
              labels: patterns.slice(0, 6).map(p => p.id || p.name || 'Unknown'),
              datasets: [{
                data: patterns.slice(0, 6).map(p => p.confidence || p.count || 1),
                backgroundColor: [
                  'rgba(72,219,251,0.8)',
                  'rgba(233,69,96,0.8)',
                  'rgba(254,202,87,0.8)',
                  'rgba(74,222,128,0.8)',
                  'rgba(168,85,247,0.8)',
                  'rgba(255,107,107,0.8)'
                ],
                borderWidth: 0
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { position: 'bottom', labels: { color: '#888' } }
              }
            }
          });

          // Patterns list
          document.getElementById('patternsList').innerHTML = patterns.map(p => `
            <div class="pattern-item">
              <div class="pattern-info">
                <div class="pattern-name">${p.id || p.name || 'Unknown'}</div>
                <div class="pattern-desc">${p.description || 'Detected pattern'}</div>
              </div>
              <div class="pattern-confidence">${((p.confidence || 0) * 100).toFixed(0)}%</div>
            </div>
          `).join('');
        } else {
          document.getElementById('patternsList').innerHTML =
            '<p style="color:var(--text-muted);padding:1rem;">No patterns detected yet. Run meta-analyzer analyze.</p>';
        }
      }

      // Routing tab
      if (ROUTING_DATA) {
        // Stats row
        document.getElementById('routingQueries').textContent = ROUTING_DATA.totalQueries || 0;
        document.getElementById('routingDqScore').textContent = (ROUTING_DATA.avgDqScore || 0).toFixed(3);
        document.getElementById('routingCostSavings').textContent =
          (ROUTING_DATA.costReduction * 100 || 0).toFixed(1) + '%';
        // Show N/A if no latency data (0 means no data collected yet)
        const latencyMs = ROUTING_DATA.routingLatency || 0;
        document.getElementById('routingLatency').textContent =
          latencyMs > 0 ? latencyMs.toFixed(0) + 'ms' : 'N/A';

        // Production readiness progress
        const queryProgress = Math.min(100, (ROUTING_DATA.totalQueries / ROUTING_DATA.targetQueries) * 100);
        const dataQualityProgress = Math.min(100, (ROUTING_DATA.dataQuality / ROUTING_DATA.targetDataQuality) * 100);
        const feedbackProgress = Math.min(100, (ROUTING_DATA.feedbackCount / ROUTING_DATA.targetFeedback) * 100);

        document.getElementById('queriesProgress').textContent =
          `${ROUTING_DATA.totalQueries}/${ROUTING_DATA.targetQueries}`;
        document.getElementById('queriesBar').style.width = queryProgress + '%';

        document.getElementById('dataQualityProgress').textContent =
          `${(ROUTING_DATA.dataQuality || 0).toFixed(2)}/${ROUTING_DATA.targetDataQuality}`;
        document.getElementById('dataQualityBar').style.width = dataQualityProgress + '%';

        document.getElementById('feedbackProgress').textContent =
          `${ROUTING_DATA.feedbackCount}/${ROUTING_DATA.targetFeedback}`;
        document.getElementById('feedbackBar').style.width = feedbackProgress + '%';

        // Status badge
        const isReady = ROUTING_DATA.productionReady;
        const statusBadge = document.getElementById('routingStatusBadge');
        if (isReady) {
          statusBadge.textContent = 'üü¢ Production Ready';
          statusBadge.style.background = 'rgba(0, 255, 136, 0.15)';
          statusBadge.style.color = 'var(--accent-green)';
        } else if (queryProgress > 50) {
          statusBadge.textContent = 'üü° Collecting Data';
          statusBadge.style.background = 'rgba(255, 204, 0, 0.15)';
          statusBadge.style.color = 'var(--accent-yellow)';
        } else {
          statusBadge.textContent = 'üî¥ Needs More Data';
          statusBadge.style.background = 'rgba(255, 77, 106, 0.15)';
          statusBadge.style.color = 'var(--accent-red)';
        }

        // Model distribution chart
        const modelDist = ROUTING_DATA.modelDistribution || {};
        const modelLabels = Object.keys(modelDist);
        const modelValues = Object.values(modelDist);

        if (modelLabels.length > 0) {
          new Chart(document.getElementById('modelDistChart'), {
            type: 'doughnut',
            data: {
              labels: modelLabels.map(m => m.charAt(0).toUpperCase() + m.slice(1)),
              datasets: [{
                data: modelValues,
                backgroundColor: [
                  'rgba(255, 204, 0, 0.8)',   // Haiku - yellow
                  'rgba(72, 219, 251, 0.8)',  // Sonnet - cyan
                  'rgba(177, 78, 255, 0.8)'   // Opus - purple
                ],
                borderWidth: 0
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { position: 'bottom', labels: { color: '#888' } }
              }
            }
          });
        }

        // Performance targets
        const accuracy = ROUTING_DATA.accuracy || 0;
        const costReduction = ROUTING_DATA.costReduction || 0;
        const latency = ROUTING_DATA.routingLatency || 0;
        const dqScore = ROUTING_DATA.avgDqScore || 0;

        document.getElementById('accuracyTarget').textContent = (accuracy * 100).toFixed(1) + '% (target: 75%)';
        document.getElementById('accuracyStatus').textContent = accuracy >= 0.75 ? '‚úÖ' : '‚è≥';

        document.getElementById('costTarget').textContent = (costReduction * 100).toFixed(1) + '% (target: 20%)';
        document.getElementById('costStatus').textContent = costReduction >= 0.20 ? '‚úÖ' : '‚è≥';

        // Handle latency (0 means no data yet, not actually 0ms latency)
        if (latency > 0) {
          document.getElementById('latencyTarget').textContent = latency.toFixed(0) + 'ms (target: <50ms)';
          document.getElementById('latencyStatus').textContent = latency < 50 ? '‚úÖ' : '‚è≥';
        } else {
          document.getElementById('latencyTarget').textContent = 'N/A (target: <50ms)';
          document.getElementById('latencyStatus').textContent = '‚è≥';
        }

        document.getElementById('dqTarget').textContent = dqScore.toFixed(3) + ' (target: 0.70)';
        document.getElementById('dqStatus').textContent = dqScore >= 0.70 ? '‚úÖ' : '‚è≥';

        // Targets met badge (only count latency if we have data)
        const targetsMet = [
          accuracy >= 0.75,
          costReduction >= 0.20,
          latency > 0 && latency < 50,  // Only count if we have data
          dqScore >= 0.70
        ].filter(Boolean).length;

        document.getElementById('targetsMetBadge').textContent = `${targetsMet}/4`;
      }
    }

    init();

    // Context Efficiency Tab - Load Pack Metrics
    async function loadPackMetrics() {
      try {
        // Mock data for now - in production, this would call: python3 pack_metrics.py --dashboard-data
        const mockData = {
          global: {
            total_sessions: 1,
            total_token_savings: 6999702,
            total_cost_savings: 21.00,
            avg_reduction_rate: 99.99
          },
          top_packs: [
            { pack_id: 'multi-agent-orchestration', times_selected: 1, avg_dq_score: 0.850, avg_consensus_score: 0.880 },
            { pack_id: 'agentic-memory', times_selected: 1, avg_dq_score: 0.850, avg_consensus_score: 0.880 },
            { pack_id: 'llm-optimization', times_selected: 1, avg_dq_score: 0.850, avg_consensus_score: 0.880 }
          ],
          best_combinations: [
            {
              packs: ['multi-agent-orchestration', 'agentic-memory', 'llm-optimization'],
              uses: 1,
              avg_savings: 6999702
            }
          ],
          daily_trend: [
            { date: '2026-01-18', sessions: 1, token_savings: 6999702, cost_savings: 21.00 }
          ],
          pack_inventory: [
            { pack_id: 'multi-agent-orchestration', type: 'domain', size_tokens: 112, keywords: ['multi-agent', 'consensus', 'voting'] },
            { pack_id: 'agentic-memory', type: 'domain', size_tokens: 93, keywords: ['memory', 'zettelkasten', 'a-mem'] },
            { pack_id: 'llm-optimization', type: 'domain', size_tokens: 93, keywords: ['optimization', 'scheduling'] },
            { pack_id: 'os-app-architecture', type: 'project', size_tokens: 45, keywords: ['react', 'vite', 'zustand'] },
            { pack_id: 'debugging-patterns', type: 'pattern', size_tokens: 43, keywords: ['debugging', 'root-cause'] }
          ]
        };

        // Update stats
        document.getElementById('totalSessions').textContent = mockData.global.total_sessions;
        document.getElementById('totalTokenSavings').textContent = mockData.global.total_token_savings.toLocaleString();
        document.getElementById('totalCostSavings').textContent = `$${mockData.global.total_cost_savings.toFixed(2)}`;
        document.getElementById('avgReduction').textContent = `${mockData.global.avg_reduction_rate.toFixed(1)}%`;

        // Top packs
        document.getElementById('topPacksCount').textContent = mockData.top_packs.length;
        const topPacksList = document.getElementById('topPacksList');
        topPacksList.innerHTML = mockData.top_packs.map(pack => `
          <div class="pack-item">
            <div class="pack-info">
              <div class="pack-name">${pack.pack_id}</div>
              <div class="pack-meta">
                <span>Uses: ${pack.times_selected}</span>
              </div>
            </div>
            <div class="pack-stats">
              <div class="pack-stat">
                <div class="pack-stat-value">${pack.avg_dq_score.toFixed(3)}</div>
                <div class="pack-stat-label">DQ Score</div>
              </div>
              <div class="pack-stat">
                <div class="pack-stat-value">${pack.avg_consensus_score.toFixed(3)}</div>
                <div class="pack-stat-label">Consensus</div>
              </div>
            </div>
          </div>
        `).join('');

        // Best combinations
        document.getElementById('combosCount').textContent = mockData.best_combinations.length;
        const combosList = document.getElementById('packCombosList');
        combosList.innerHTML = mockData.best_combinations.map(combo => `
          <div class="combo-item">
            <div class="combo-packs">
              ${combo.packs.map(p => `<span class="combo-pack-tag">${p}</span>`).join('')}
            </div>
            <div class="combo-stats">
              <div class="combo-stat">
                <span>Uses:</span>
                <span class="combo-stat-value">${combo.uses}</span>
              </div>
              <div class="combo-stat">
                <span>Avg Savings:</span>
                <span class="combo-stat-value">${combo.avg_savings.toLocaleString()} tokens</span>
              </div>
            </div>
          </div>
        `).join('');

        // Pack inventory
        document.getElementById('packInventoryCount').textContent = mockData.pack_inventory.length;
        const inventoryList = document.getElementById('packInventoryList');
        inventoryList.innerHTML = mockData.pack_inventory.map(pack => `
          <div class="pack-item">
            <div class="pack-info">
              <div class="pack-name">${pack.pack_id}</div>
              <div class="pack-meta">
                <span>Type: ${pack.type}</span>
                <span>Size: ${pack.size_tokens} tokens</span>
                <span>Keywords: ${pack.keywords.slice(0, 3).join(', ')}</span>
              </div>
            </div>
          </div>
        `).join('');

        // Daily trend chart
        const ctx = document.getElementById('savingsTrendChart');
        if (ctx) {
          new Chart(ctx, {
            type: 'line',
            data: {
              labels: mockData.daily_trend.map(d => d.date),
              datasets: [{
                label: 'Token Savings',
                data: mockData.daily_trend.map(d => d.token_savings),
                borderColor: '#00ff88',
                backgroundColor: 'rgba(0, 255, 136, 0.1)',
                tension: 0.4,
                fill: true
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  grid: { color: 'rgba(255,255,255,0.06)' },
                  ticks: {
                    color: '#8a8a9a',
                    callback: function(value) {
                      return value.toLocaleString();
                    }
                  }
                },
                x: {
                  grid: { color: 'rgba(255,255,255,0.06)' },
                  ticks: { color: '#8a8a9a' }
                }
              }
            }
          });
        }

      } catch (error) {
        console.error('Error loading pack metrics:', error);
      }
    }

    // Load pack metrics when tab is accessed
    document.querySelector('[data-tab="context-efficiency"]')?.addEventListener('click', () => {
      setTimeout(loadPackMetrics, 100);
    });

    // Load on page load if tab is active
    if (document.getElementById('context-efficiency')?.classList.contains('active')) {
      loadPackMetrics();
    }
  </script>
</body>
</html>
